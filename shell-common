alias open=xdg-open
alias o=xdg-open
alias :q=exit
export EDITOR=nvim
alias grep="grep --color=auto"
alias cmake="PATH=/usr/lib/ccache:$PATH cmake"

technical-details() {
    printf '- System: '
    nixos-version
    printf '- Nix version: '
    nix-env --version
    printf '- Nixpkgs version: '
    nix-instantiate --eval '<nixpkgs>' -A lib.nixpkgsVersion
}

store() {
    readlink -f $(which "$@")
}

TERM_EM=$(basename -- "$(ps -ocommand= -p $PPID | awk '{ print $1 }')")
case $TERM_EM in
    konsole|lxterminal|gnome-terminal-server)
        export TERM=xterm-256color ;;
    fbterm)
        export TERM=fbterm ;;
esac

add_to_path() {
    local path_arr already_there OLDIFS shell
    shell="$(ps -o comm= $$)"
    case "$shell" in
    *zsh)
        OLDIFS="$IFS"
        IFS=:
        echo $PATH | read -A path_arr
        IFS=$OLDIFS
        ;;
    *bash)
        IFS=: read -a path_arr <<< "$PATH"
        ;;
    *)
        # Fall back to adding it unconditionally
        export PATH="$1:$PATH"
        ;;
    esac
    while [ -n "$1" ] ; do
        already_there=false
        for item in "${path_arr[@]}" ; do
            if [ "$1" = "$item" ] ; then
                already_there=true
                break
            fi
        done
        if ! $already_there ; then
            PATH=$1:$PATH
        fi
        shift
    done
}

for p in ~/bin ~/.local/bin ; do
    [ -d $p ] && add_to_path $p
done

! [ -f "$DOTFILES_HOME/shell-local" ] || source "$DOTFILES_HOME/shell-local"
